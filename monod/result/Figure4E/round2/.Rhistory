M <- matrix(runif(400),20,20)
M[lower.tri(M)] <- NA
M[M>0.4]<-1
image(M,col = col,frame=F,xaxt="n",yaxt="n")
M<-matrix(sample(c(0,1,1,1),1000,replace=T),10,10)
col=colorRampPalette(c("white", "red"))(20)
circle=c(1,19)
plot(x=nrow(M),y=ncol(M),type="n",xlab="",ylab="",xlim=c(0,ncol(M)),ylim=c(0,nrow(M)))
for(i in 1:nrow(M)){
for(j in 1:ncol(M)){
points(i,j,col=1,pch=circle[M[i,j]+1],cex=1.5)
}
}
library("grDevices")
col=colorRampPalette(c("white", "red"))(20)
M <- matrix(runif(400),20,20)
M[lower.tri(M)] <- NA
M[M>0.4]<-1
image(M,col = col,frame=F,xaxt="n",yaxt="n")
library("grDevices")
col=colorRampPalette(c("white", "red"))(20)
M <- matrix(runif(400),20,20)
M[lower.tri(M)] <- NA
M[M>0.3]<-1
image(M,col = col,frame=F,xaxt="n",yaxt="n")
library("grDevices")
col=colorRampPalette(c("white", "red"))(20)
M <- matrix(runif(400),20,20)
M[lower.tri(M)] <- NA
M[M>0.2]<-1
image(M,col = col,frame=F,xaxt="n",yaxt="n")
par(mar=c(0.1,1,1,1))
CHR<-data[,1]  # Chromosomes
MapInfo<-data[,2]# position on chromosome
chrompos1<-prepareGenomePlot(data.frame(CHR,MapInfo),paintCytobands = TRUE, organism="hsa",sexChromosomes = TRUE,units="bases",cols="green")
points(chrompos[,2],chrompos[,1]+0.2,pch="|",col="red",cex=1.1)
dev.off()
data<-read.table("C:\Users\shicheng\Downloads\chrom.plot.txt",head=F,sep="\t",as.is=T)
data<-read.table("C:\\Users\\shicheng\\Downloads\\chrom.plot.txt",head=F,sep="\t",as.is=T)
chrompos<-data
data[,1]<-gsub("chr","",data[,1])
pdf("chrosomeplot.pdf")
par(mar=c(0.1,1,1,1))
CHR<-data[,1]  # Chromosomes
MapInfo<-data[,2]# position on chromosome
chrompos<-prepareGenomePlot(data.frame(CHR,MapInfo),paintCytobands = TRUE, organism="hsa",sexChromosomes = TRUE,units="bases",cols="green")
points(chrompos[,2],chrompos[,1]+0.2,pch="|",col="red",cex=1.1)
dev.off()
library("quantsmooth")
chrompos<-prepareGenomePlot(data.frame(CHR,MapInfo),paintCytobands = TRUE, organism="hsa",sexChromosomes = TRUE,units="bases",cols="green")
points(chrompos[,2],chrompos[,1]+0.2,pch="|",col="red",cex=1.1)
head(chrompos)
head(CHR)
head(MapInfo)
head(data)
data<-read.table("C:\\Users\\shicheng\\Downloads\\chrom.plot.txt",head=T,row.names=1,,sep="\t",as.is=T)
data<-read.table("C:\\Users\\shicheng\\Downloads\\chrom.plot.txt",head=T,row.names=1,sep="\t",as.is=T)
chrompos<-data
data[,1]<-gsub("chr","",data[,1])
pdf("chrosomeplot.pdf")
par(mar=c(0.1,1,1,1))
CHR<-data[,1]  # Chromosomes
MapInfo<-data[,2]# position on chromosome
chrompos<-prepareGenomePlot(data.frame(CHR,MapInfo),paintCytobands = TRUE, organism="hsa",sexChromosomes = TRUE,units="bases",cols="green")
points(chrompos[,2],chrompos[,1]+0.2,pch="|",col="red",cex=1.1)
dev.off()
dev.off()
head(data)
CHR<-data[,1]  # Chromosomes
MapInfo<-data[,2]# position on chromosome
chrompos<-prepareGenomePlot(data.frame(CHR,MapInfo),paintCytobands = TRUE, organism="hsa",sexChromosomes = TRUE,units="bases",cols="green")
points(chrompos[,2],chrompos[,1]+0.2,pch="|",col="red",cex=1.1)
pdf("chrosomeplot.pdf")
par(mar=c(0.1,1,1,1))
CHR<-data[,1]  # Chromosomes
MapInfo<-data[,2]# position on chromosome
chrompos<-prepareGenomePlot(data.frame(CHR,MapInfo),paintCytobands = TRUE, organism="hsa",sexChromosomes = TRUE,units="bases",cols="green")
points(chrompos[,2],chrompos[,1]+0.2,pch="|",col="red",cex=1.1)
dev.off()
getwd()
69 +26 + 15
774/3225
length(target1.colon)
data=data[target1.colon,]
colon.data=data
cp<-tp<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
tp<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,tp,np)
load("dp.colon.RData")
head(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("TP",length(dp[,1])),rep("NP",length(dp[,1])))
dataSummary<-data.frame(dp2,type)
head(dataSummary)
myData <- aggregate(dataSummary$dp2,by =list(type=dataSummary$type),
FUN = function(x) c(mean = mean(x), sd = sd(x),
n=as.numeric(length(x)),
sem=sd(x)/sqrt(as.numeric(length(x))),
me=qt(1-0.05/2,df=length(x)*sd(x)/sqrt(as.numeric(length(x)))))
)
myData <- do.call(data.frame, myData)
colnames(myData)=c("type","mean","sd","n","sem","me")
myData
myData$type <- factor(myData$type, levels = c("CP","TP","NP"))
myData
length(target1.colon)
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\result\\Figure4E\\round2")
load("dp.colon.RData")
head(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("TP",length(dp[,1])),rep("NP",length(dp[,1])))
dataSummary<-data.frame(dp2,type)
head(dataSummary)
myData <- aggregate(dataSummary$dp2,by =list(type=dataSummary$type),
FUN = function(x) c(mean = mean(x), sd = sd(x),
n=as.numeric(length(x)),
sem=sd(x)/sqrt(as.numeric(length(x))),
me=qt(1-0.05/2,df=length(x)*sd(x)/sqrt(as.numeric(length(x)))))
)
myData <- do.call(data.frame, myData)
colnames(myData)=c("type","mean","sd","n","sem","me")
myData
myData$type <- factor(myData$type, levels = c("CP","TP","NP"))
myData
# Plot one standard error (standard error of the mean/SEM)
pdf("barplot.ggplot2.pdf", height = 3, width = 3)
tiff("barplot.ggplot2.tiff",res=300)
ggplot(myData, aes(x =type, y = mean)) +
geom_bar(position = position_dodge(), stat="identity", fill="blue") +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),size=1.05) +
ggtitle("Colon Cancer") +
theme_bw() +
theme(panel.grid.major = element_blank())+
xlab("") +
ylab("Average of Methyaltion Haplotype Load")+
theme(axis.text=element_text(size=20),axis.title=element_text(size=20))
dev.off()
ggplot(myData, aes(x =type, y = mean)) +
geom_bar(position = position_dodge(), stat="identity", fill="blue") +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),size=1.05) +
ggtitle("Colon Cancer") +
theme_bw() +
theme(panel.grid.major = element_blank())+
xlab("") +
ylab("Average of Methyaltion Haplotype Load")+
theme(axis.text=element_text(size=20),axis.title=element_text(size=20))
library("ggplot2")
ggplot(myData, aes(x =type, y = mean)) +
geom_bar(position = position_dodge(), stat="identity", fill="blue") +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),size=1.05) +
ggtitle("Colon Cancer") +
theme_bw() +
theme(panel.grid.major = element_blank())+
xlab("") +
ylab("Average of Methyaltion Haplotype Load")+
theme(axis.text=element_text(size=20),axis.title=element_text(size=20))
ggplot(myData, aes(x =type, y = mean)) +
geom_bar(position = position_dodge(), stat="identity", fill="blue") +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),size=1.05) +
ggtitle("Colon Cancer") +
theme_bw() +
theme(panel.grid.major = element_blank())+
xlab("") +
ylab("Average of Methyaltion Haplotype Load")+
theme(axis.text=element_text(size=20),axis.title=element_text(size=20))
dev.off()
dev.off()
myData
ggplot(myData, aes(x =type, y = mean)) +
geom_bar(position = position_dodge(), stat="identity", fill="blue") +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),size=1.05) +
ggtitle("Colon Cancer") +
theme_bw() +
theme(panel.grid.major = element_blank())+
xlab("") +
ylab("Average of Methyaltion Haplotype Load")+
theme(axis.text=element_text(size=20),axis.title=element_text(size=20))
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
data1<-read.table("/home/shg047/monod/rrbs_kun/rrbs.kun.mhl.na.impute.txt",head=T,as.is=T, check.name=F)
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\result\\Figure4E")
data1<-read.table("rrbs.kun.mhl.na.impute.txt",head=T,as.is=T, check.name=F)
data1<-read.table("rrbs.kun.mhl.na.impute.txt",head=T,as.is=T, check.name=F,sep="\t")
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\result\\Figure4E\\round2")
data1<-read.table("rrbs.kun.mhl.na.impute.txt",head=T,as.is=T, check.name=F)
data1<-read.table("rrbs.kun.mhl.na.impute.txt",head=T,as.is=T)
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
length(target1.colon)
data=data[target1.colon,]
colon.data=data
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\result\\Figure4E\\round2")
data1<-read.table("rrbs.kun.mhl.na.impute.txt",head=T,as.is=T)
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
data1<-read.table("rrbs.kun.mhl.na.impute.txt",head=T,as.is=T)
colnames(data1)<-gsub("RRBS-6P","6-P-",colnames(data1))
colnames(data1)<-gsub("RRBS-7P","7-P-",colnames(data1))
colnames(data1)
data1<-read.table("rrbs.kun.mhl.na.impute.txt",head=T,as.is=T,check.name=F)
data1<-read.table("rrbs.kun.mhl.na.impute.txt",head=T,as.is=T,check.name=F,row.names=1)
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\result\\Figure4E\\round2")
load("data.RData")
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
length(target1.colon)
data=data[target1.colon,]
colon.data=data
cp<-tp<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
tp<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,tp,np)
save(dp,file="dp.colon.RData")
load("dp.colon.RData")
head(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
dataSummary<-data.frame(dp2,type)
head(dataSummary)
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
length(target1.colon)
data=data[target1.colon,]
colon.data=data
cp<-tp<-np<-c()
cp<-ct<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
ct<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,tp,np)
save(dp,file="dp.colon.RData")
load("dp.colon.RData")
head(dp)
dim(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
dataSummary<-data.frame(dp2,type)
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
length(target1.colon)
data=data[target1.colon,]
colon.data=data
cp<-ct<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
ct<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,tp,np)
save(dp,file="dp.colon.RData")
load("dp.colon.RData")
head(dp)
dim(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
dataSummary<-data.frame(dp2,type)
type
load("dp.colon.RData")
head(dp)
dim(dp)
dp2<-as.numeric(dp)
dp2
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
dataSummary<-data.frame(dp2,type)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
type
length(dp2)
dataSummary<-data.frame(dp2,type)
length(type)
dp
length(dp[,1])
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
length(type)
colon.data=data
cp<-ct<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
ct<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,ct,np)
save(dp,file="dp.colon.RData")
load("dp.colon.RData")
head(dp)
dim(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
length(type)
dataSummary<-data.frame(dp2,type)
head(dataSummary)
myData <- aggregate(dataSummary$dp2,by =list(type=dataSummary$type),
FUN = function(x) c(mean = mean(x), sd = sd(x),
n=as.numeric(length(x)),
sem=sd(x)/sqrt(as.numeric(length(x))),
me=qt(1-0.05/2,df=length(x)*sd(x)/sqrt(as.numeric(length(x)))))
)
dataSummary$dp2
myData <- aggregate(dataSummary$dp2,by =list(type=dataSummary$type),
FUN = function(x) c(mean = mean(x), sd = sd(x),
n=as.numeric(length(x)),
sem=sd(x)/sqrt(as.numeric(length(x))),
me=qt(1-0.05/2,df=length(x)*sd(x)/sqrt(as.numeric(length(x)))))
)
dataSummary
myData <- aggregate(dataSummary$dp2,by =list(type=dataSummary$type),
FUN = function(x) c(mean = mean(x), sd = sd(x),
n=as.numeric(length(x)),
sem=sd(x)/sqrt(as.numeric(length(x))),
me=qt(1-0.05/2,df=as.numeric(length(x))*sd(x)/sqrt(as.numeric(length(x)))))
)
dataSummary$type
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
length(target1.colon)
data=data[target1.colon,]
colon.data=data
cp<-ct<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
ct<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,ct,np)
save(dp,file="dp.colon.RData")
load("dp.colon.RData")
head(dp)
dim(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
length(type)
dataSummary<-data.frame(dp2,type)
head(dataSummary)
myData <- aggregate(dataSummary$dp2,by =list(type=dataSummary$type),
FUN = function(x) c(mean = mean(x), sd = sd(x),
n=as.numeric(length(x)),
sem=sd(x)/sqrt(as.numeric(length(x))),
me=qt(1-0.05/2,df=as.numeric(length(x))*sd(x)/sqrt(as.numeric(length(x)))))
)
myData
myData
dataSummary
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
length(target1.colon)
data=data[target1.colon,]
colon.data=data
cp<-ct<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
ct<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,ct,np)
save(dp,file="dp.colon.RData")
load("dp.colon.RData")
head(dp)
dim(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
length(type)
dataSummary<-data.frame(dp2,type)
dataSummary
load("data.RData")
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
length(target1.colon)
data=data[target1.colon,]
colon.data=data
cp<-ct<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
ct<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,ct,np)
save(dp,file="dp.colon.RData")
load("dp.colon.RData")
head(dp)
dim(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
length(type)
dataSummary<-data.frame(dp2,type)
head(dataSummary)
myData <- aggregate(dataSummary$dp2,by =list(type=dataSummary$type),
FUN = function(x) c(mean = mean(x), sd = sd(x),
n=as.numeric(length(x)),
sem=sd(x)/sqrt(as.numeric(length(x))),
me=qt(1-0.05/2,df=as.numeric(length(x))*sd(x)/sqrt(as.numeric(length(x)))))
)
myData <- do.call(data.frame, myData)
load("data.RData")
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
length(target1.colon)
data=data[target1.colon,]
colon.data=data
cp<-ct<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
ct<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,ct,np)
save(dp,file="dp.colon.RData")
load("dp.colon.RData")
head(dp)
dim(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
length(type)
dataSummary<-data.frame(dp2,type)
head(dataSummary)
dataSummary
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\result\\Figure4E\\round2")
load("data.RData")
load("data.RData")
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
length(target1.colon)
data=data[target1.colon,]
colon.data=data
cp<-ct<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
ct<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,ct,np)
save(dp,file="dp.colon.RData")
load("dp.colon.RData")
head(dp)
dim(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
length(type)
dataSummary<-data.frame(dp2,type)
head(dataSummary)
myData <- aggregate(dataSummary$dp2,by =list(type=dataSummary$type),
FUN = function(x) c(mean = mean(x), sd = sd(x),
n=as.numeric(length(x)),
sem=sd(x)/sqrt(as.numeric(length(x))),
me=qt(1-0.05/2,df=as.numeric(length(x))*sd(x)/sqrt(as.numeric(length(x)))))
)
dataSummary
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\result\\Figure4E\\round2")
load("data.RData")
load("data.RData")
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
length(target1.colon)
data=data[target1.colon,]
colon.data=data
cp<-ct<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
ct<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,ct,np)
save(dp,file="dp.colon.RData")
load("dp.colon.RData")
head(dp)
dim(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
length(type)
dataSummary<-data.frame(dp2,type)
head(dataSummary)
dataSummary
load("data.RData")
data<-data1[,c(grep("6-P",colnames(data1)),grep("6-T",colnames(data1)),grep("NC-P",colnames(data1)))]
colnames(data)
target1.colon<-which(apply(data,1,function(x) sum(x[31:35]>0.3)>=3 && sum(x[36:55]>0.03)<=8))
length(target1.colon)
data=data[target1.colon,]
colon.data=data
cp<-ct<-np<-c()
for(i in 1:length(target1.colon)){
cp<-c(cp,mean(as.numeric(data[i,1:30])))
ct<-c(tp,mean(as.numeric(data[i,31:35])))
np<-c(np,mean(as.numeric(data[i,36:55])))
}
dp<-cbind(cp,ct,np)
save(dp,file="dp.colon.RData")
load("dp.colon.RData")
head(dp)
dim(dp)
dp2<-as.numeric(dp)
type<-c(rep("CP",length(dp[,1])),rep("CT",length(dp[,1])),rep("NP",length(dp[,1])))
length(type)
dataSummary<-data.frame(dp2,type)
head(dataSummary)
(dataSummary)
