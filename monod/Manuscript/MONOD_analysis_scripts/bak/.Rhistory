mydata<-cbind(CCP,LCP,NCP)
colnames(mydata)[grep("LCP|X6|.6P",colnames(mydata))]<-"LCP"
colnames(mydata)[grep("CCP|X7|.7P",colnames(mydata))]<-"CCP"
colnames(mydata)[grep("NCP",colnames(mydata))]<-"NCP"
#hclustfunc <- function(x) hclust(x, method="complete")
#distfunc <- function(x) dist(x, method="euclidean")
# perform clustering on rows and columns
#cl.row <- hclustfunc(distfunc(mydata))
#cl.col <- hclustfunc(distfunc(t(mydata)))
# extract cluster assignments; i.e. k=8 (rows) k=5 (columns)
#gr.row <- cutree(cl.row, 6)
# gr.col <- cutree(cl.col, 5)
# require(RColorBrewer)
#col1 <- brewer.pal(6, "Set1")     # the maximum of brewer.pal is 12
#col2 <- brewer.pal(5, "Pastel1")
tol21rainbow= c("#771155", "#AA4488", "#CC99BB", "#114477", "#4477AA", "#77AADD", "#117777", "#44AAAA", "#77CCCC", "#117744", "#44AA77", "#88CCAA", "#777711", "#AAAA44", "#DDDD77", "#774411", "#AA7744", "#DDAA77", "#771122", "#AA4455", "#DD7788")
col1<-tol21rainbow[as.numeric(as.factor(rownames(mydata)))]
col2<-tol21rainbow[as.numeric(as.factor(colnames(mydata)))]
col=colorRampPalette(c("blue", "yellow"))(20)
require(gplots)
NCP<-data.matrix(read.table("normal-ref.txt",sep="\t",head=T,row.names=1,as.is=T))
setwd("C:\\Users\\shg047\\Dropbox\\Project\\methylation\\monod\\Manuscript\\MONOD_analysis_scripts\\bak")
NCP<-data.matrix(read.table("normal-ref.txt",sep="\t",head=T,row.names=1,as.is=T))
CCP<-data.matrix(read.table("CCP.txt",sep="\t",head=T,row.names=1,as.is=T))
LCP<-data.matrix(read.table("LCP.txt",sep="\t",head=T,row.names=1,as.is=T))
dim(normal)
dim(CCP)
dim(LCP)
mydata<-cbind(CCP,LCP,NCP)
colnames(mydata)[grep("LCP|X6|.6P",colnames(mydata))]<-"LCP"
colnames(mydata)[grep("CCP|X7|.7P",colnames(mydata))]<-"CCP"
colnames(mydata)[grep("NCP",colnames(mydata))]<-"NCP"
#hclustfunc <- function(x) hclust(x, method="complete")
#distfunc <- function(x) dist(x, method="euclidean")
# perform clustering on rows and columns
#cl.row <- hclustfunc(distfunc(mydata))
#cl.col <- hclustfunc(distfunc(t(mydata)))
# extract cluster assignments; i.e. k=8 (rows) k=5 (columns)
#gr.row <- cutree(cl.row, 6)
# gr.col <- cutree(cl.col, 5)
# require(RColorBrewer)
#col1 <- brewer.pal(6, "Set1")     # the maximum of brewer.pal is 12
#col2 <- brewer.pal(5, "Pastel1")
tol21rainbow= c("#771155", "#AA4488", "#CC99BB", "#114477", "#4477AA", "#77AADD", "#117777", "#44AAAA", "#77CCCC", "#117744", "#44AA77", "#88CCAA", "#777711", "#AAAA44", "#DDDD77", "#774411", "#AA7744", "#DDAA77", "#771122", "#AA4455", "#DD7788")
col1<-tol21rainbow[as.numeric(as.factor(rownames(mydata)))]
col2<-tol21rainbow[as.numeric(as.factor(colnames(mydata)))]
col=colorRampPalette(c("blue", "yellow"))(20)
require(gplots)
par(mar=c(5,5,5,0))
heatmaprlt<-heatmap.2(as.matrix(mydata),hclustfun=hclustfunc, distfun=distfunc,
RowSideColors=col1,
ColSideColors=col2,
labRow=F,
trace="none",
Colv=F,
Rowv=F,
col=col,
density.info="none")
legend=unique(data.frame(col2,as.factor(colnames(mydata))))
legend(x=0.9,y=0.8,legend=legend[,2],col=as.character(legend[,1]),pch=15,cex = 0.5)
legend=unique(data.frame(col1,as.factor(rownames(mydata))))
legend(x=0.9,y=0.5,legend=legend[,2],col=as.character(legend[,1]),pch=15,cex = 0.5)
par(mar=c(5,5,5,0))
heatmaprlt<-heatmap.2(as.matrix(mydata),hclustfun=hclustfunc, distfun=distfunc,
RowSideColors=col1,
ColSideColors=col2,
labRow=F,
trace="none",
Colv=F,
Rowv=F,
col=col,
density.info="none")
legend=unique(data.frame(col2,as.factor(colnames(mydata))))
legend(x=0.9,y=0.8,legend=legend[,2],col=as.character(legend[,1]),pch=15,cex = 0.5)
legend=unique(data.frame(col1,as.factor(rownames(mydata))))
legend(x=0.9,y=0.5,legend=legend[,2],col=as.character(legend[,1]),pch=15,cex = 0.5)
par(mar=c(5,1,5,0))
heatmaprlt<-heatmap.2(as.matrix(mydata),hclustfun=hclustfunc, distfun=distfunc,
RowSideColors=col1,
ColSideColors=col2,
labRow=F,
trace="none",
Colv=F,
Rowv=F,
col=col,
density.info="none")
legend=unique(data.frame(col2,as.factor(colnames(mydata))))
legend(x=0.9,y=0.8,legend=legend[,2],col=as.character(legend[,1]),pch=15,cex = 0.5)
legend=unique(data.frame(col1,as.factor(rownames(mydata))))
legend(x=0.9,y=0.5,legend=legend[,2],col=as.character(legend[,1]),pch=15,cex = 0.5)
dev.off()
par(mar=c(5,1,5,0))
heatmaprlt<-heatmap.2(as.matrix(mydata),hclustfun=hclustfunc, distfun=distfunc,
RowSideColors=col1,
ColSideColors=col2,
labRow=F,
trace="none",
Colv=F,
Rowv=F,
col=col,
density.info="none")
legend=unique(data.frame(col2,as.factor(colnames(mydata))))
legend(x=0.9,y=0.8,legend=legend[,2],col=as.character(legend[,1]),pch=15,cex = 0.5)
legend=unique(data.frame(col1,as.factor(rownames(mydata))))
legend(x=0.9,y=0.5,legend=legend[,2],col=as.character(legend[,1]),pch=15,cex = 0.5)
