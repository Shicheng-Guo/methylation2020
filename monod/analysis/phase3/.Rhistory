source("https://bioconductor.org/biocLite.R")
biocLite("charm")
library("charm")
library("charm")
ls()
cor2bed<-function(cor){
a<-unlist(lapply(strsplit(cor,split=c(":")),function(x) strsplit(x,"-")))
bed<-matrix(a,ncol=3,byrow=T)
return(data.frame(bed))
}
Rbedtools<-function(functionstring="intersectBed",bed1,bed2,opt.string=""){
#create temp files
a.file=tempfile()
b.file=tempfile()
out   =tempfile()
options(scipen =99) # not to use scientific notation when writing out
#write bed formatted dataframes to tempfile
write.table(bed1,file=a.file,quote=F,sep="\t",col.names=F,row.names=F)
write.table(bed2,file=b.file,quote=F,sep="\t",col.names=F,row.names=F)
# create the command string and call the command using system()
command=paste(functionstring,"-a",a.file,"-b",b.file,opt.string,">",out,sep=" ")
cat(command,"\n")
try(system(command))
res=read.table(out,header=F)
unlink(a.file);unlink(b.file);unlink(out)
return(res)
}
file="WGBS_pooled_mappable_bins.mld_blocks_r2-0.5.bed"
cgi="/home/shg047/bioin/annotation/hg19/hg19.cpgIslandExt.txt"
cgshore="/home/shg047/bioin/annotation/hg19/hg19.cpgshoreExt.bed"
cgshelf="/home/shg047/bioin/annotation/hg19/hg19.cpgshelfExt.bed"
refgene="/home/shg047/bioin/annotation/hg19/hg19_refGene.bed"
repeatmask="/home/shg047/bioin/annotation/hg19/hg19.repeatmasker.bed"
tss="/home/shg047/bioin/annotation/hg19/hg19.refGeneTSS.bed"
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\phase3")
file="WGBS_pooled_mappable_bins.mld_blocks_r2-0.5.bed"
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\phase3")
mhb<-read.table("WGBS_pooled_mappable_bins.mld_blocks_r2-0.5.bed")
head(mhb)
len<-mhb[,3]-mhb[,2]
hist(len)
hist(len)
hist(len)
hist(len,breaks=200)
hist(len[len<400],breaks=200)
hist(len[len<350],breaks=200)
hist(len[len<350],breaks=200,main="")
hist(len[len<350],breaks=200,main="",xlab="")
hist(len[len<350],breaks=200,main="",xlab="",ylab="")
hist(len[len<350],breaks=200,main="",xlab="",ylab="",col="red")
hist(len[len<350],breaks=200,main="",xlab="",ylab="",col="red",fill="red")
hist(len[len<350],breaks=200,main="",xlab="",ylab="",col="blue")
hist(len[len<350],breaks=150,main="",xlab="",ylab="",col="blue")
hist(len[len<350],breaks=100,main="",xlab="",ylab="",col="blue")
297/210
4/3
1189/4
? dmrcate
library(""MethylMix"")
library("MethylMix")
source("http://bioconductor.org/biocLite.R")
source("http://bioconductor.org/biocLite.R")
biocLite("MethylMix")
library("MethylMix")
ls()
library(GenomicRanges)
library(rtracklayer)
library(Rsamtools)
