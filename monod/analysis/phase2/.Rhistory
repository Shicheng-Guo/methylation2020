source("https://bioconductor.org/biocLite.R")
biocLite("charm")
library("charm")
library("charm")
ls()
install.packages("randomForest")
library("Rtsn")
library("randomForest")
install.packages("Rtsne")
install.packages("randomForest")
library("Rtsn")
library("randomForest")
library("Rtsne")
library("randomForest")
install.packages("C:/Users/shicheng/Downloads/randomForest_4.6-10.tar.gz", repos = NULL, type = "source")
x<-c(25,28,31,35,43,48,51,40,35,29)
plot(x)
names(x)<-c("-4*up","-3*up","-2*up","-1*up","Domain","-1*down","-2*down","-3*down","-4*down")
plot(x)
x<-c(25,28,31,35,43,48,51,40,35,29)
names(x)<-c("-4*up","-3*up","-2*up","-1*up","Domain","-1*down","-2*down","-3*down","-4*down")
plot(x)
x
barplt(x)
barplot(x)
x<-c(28,31,35,43,48,51,40,35,29,28)
names(x)<-c("-4*up","-3*up","-2*up","-1*up","Domain","-1*down","-2*down","-3*down","-4*down")
barplot(x)
x<-c(28,31,35,43,48,48,40,35,29,28)
names(x)<-c("-4*up","-3*up","-2*up","-1*up","Domain","-1*down","-2*down","-3*down","-4*down")
barplot(x)
x<-c(28,31,35,43,48,47,40,35,29,28)
names(x)<-c("-4*up","-3*up","-2*up","-1*up","Domain","-1*down","-2*down","-3*down","-4*down")
barplot(x)
x<-c(29,31,36,43,48,47,40,35,29,28)
names(x)<-c("-4*up","-3*up","-2*up","-1*up","Domain","-1*down","-2*down","-3*down","-4*down")
barplot(x,cor)
x<-c(29,31,36,43,48,47,40,35,29,28)
names(x)<-c("-4*up","-3*up","-2*up","-1*up","Domain","-1*down","-2*down","-3*down","-4*down")
barplot(x,cor)
barplot(x,cor="blue")
x<-c(29,31,36,43,48,47,40,35,29,28)
names(x)<-c("-4*up","-3*up","-2*up","-1*up","Domain","-1*down","-2*down","-3*down","-4*down")
barplot(x,cor="blue")
? barplot
barplot(x,col="blue")
x<-c(29,31,36,43,48,47,40,35,29,28)
names(x)<-c("-4*up","-3*up","-2*up","-1*up","Domain","-1*down","-2*down","-3*down","-4*down")
barplot(x,col="blue")
barplot(x,col="blue",ylim=c(0,49))
barplot(x,col="blue",ylim=c(0,50))
448/220
44/220
48/0.000969
48/220
5848/46817
4269/46817
690*2+8249
3108.46*12
x<-c(rep(0,294.3),rep(1,45.3),rep(2,5,5),rep(3,0))
x
density(x)
plot(density(x))
for(i in seq(0,1,by=0.005)){
y<-i/(i+2)
}
plot(y)
y<-c()
for(i in seq(0,1,by=0.005)){
y<-c(y,i/(i+2))
}
plot(y)
y<-c()
x<-c()
for(i in seq(0,1,by=0.005)){
y<-c(y,i/(i+2))
x<-c(x,i)
}
plot(y=y,x=x)
plot(y=y,x=x,xlab="lamdi")
plot(y=y,x=x,xlab="lamdi",ylab="Proportion",)
plot(y=y,x=x,xlab="lamdi",ylab="Proportion",lty=1)
plot(y=y,x=x,xlab="lamdi",ylab="Proportion",type="l")
plot(y=y,x=x,xlab="lamdi",ylab="Proportion",type="l",lwd=2,col="red")
abline(v=0.1047)
plot(y=y,x=x,xlab="lamdi",ylab="Proportion",type="l",lwd=2,col="red")
abline(h=0.1047)
abline(h=0.1047,col="grey")
v<-data.frame(x,y)
v
0.105/0.235
0.235/exp(0.235)
0.105/exp(0.105)
abline(h=0.1047,col="grey1",lty=2)
abline(h=0.05,col="dark",lty=2)
abline(h=0.05,col="blue",lty=2)
plot(y=y,x=x,xlab="Concentration",ylab="Proportion",type="l",lwd=2,col="red")
12.5/0.235
plot(y=y,x=x*53.2,xlab="Concentration",ylab="Proportion",type="l",lwd=2,col="red")
abline(h=0.1047,col="grey1",lty=2)
abline(h=0.05,col="blue",lty=2)
plot(y=y,x=x*53.2,xlab="Concentration (ul)",ylab="Proportion",type="l",lwd=2,col="red")
abline(h=0.1047,col="grey1",lty=2)
abline(h=0.05,col="blue",lty=2)
x<-c()
y<-c()
for(i in seq(0,0.5,by=0.05)){
y<-c(y,i/(i+2))
x<-c(x,i)
}
plot(x,y)
plot(x,y,type="l",lwd=2,col="red")
for(i in seq(0,0.4,by=0.05)){
y<-c(y,i/(i+2))
x<-c(x,i)
}
x<-c()
y<-c()
for(i in seq(0,0.4,by=0.05)){
y<-c(y,i/(i+2))
x<-c(x,i)
}
plot(x,y,type="l",lwd=2,col="red")
plot(x,y,type="l",lwd=2,col="red",ylab="Propotion",xlab=c("Concentration"))
plot(x,y,type="l",lwd=2,col="red",ylab="Proportion",xlab=c("Concentration"))
abline(h=0.235)
abline(h=0.05)
abline(h=0.05,col="grey",type=2)
abline(h=0.105,col="grey",type=2)
abline(h=0.05,col="grey",type=2)
abline(h=0.05,col="blue",type=2)
plot(x,y,type="l",lwd=2,col="red",ylab="Proportion",xlab=c("Concentration"))
abline(h=0.105,col="grey",type=2)
abline(h=0.05,col="blue",type=2)
abline(h=0.105,col="grey",lty=2)
abline(h=0.05,col="blue",lty=2)
plot(x,y,type="l",lwd=2,col="red",ylab="Proportion",xlab=c("Concentration"))
abline(h=0.105,col="grey",lty=2)
abline(h=0.05,col="blue",lty=2)
plot(x=x*106,y,type="l",lwd=2,col="red",ylab="Proportion",xlab=c("Concentration"))
abline(h=0.105,col="grey",lty=2)
abline(h=0.05,col="blue",lty=2)
499*6.2
df <- data.frame(
trt = factor(c(1, 1, 2, 2)),
resp = c(1, 5, 3, 4),
group = factor(c(1, 2, 1, 2)),
se = c(0.1, 0.3, 0.3, 0.2)
)
df2 <- df[c(1,3),]
df2
limits <- aes(ymax = resp + se, ymin=resp - se)
library("ggplot2")
df <- data.frame(
trt = factor(c(1, 1, 2, 2)),
resp = c(1, 5, 3, 4),
group = factor(c(1, 2, 1, 2)),
se = c(0.1, 0.3, 0.3, 0.2)
)
df2 <- df[c(1,3),]
df2
# Define the top and bottom of the errorbars
limits <- aes(ymax = resp + se, ymin=resp - se)
limits
? aes
resp
limits <- aes(ymax = resp + se, ymin=resp - se)
resp
? df
df <- data.frame(
trt = factor(c(1, 1, 2, 2)),
resp = c(1, 5, 3, 4),
group = factor(c(1, 2, 1, 2)),
se = c(0.1, 0.3, 0.3, 0.2)
)
df2 <- df[c(1,3),]
df2
data <- matrix(1:1024, nrow=1024)
image(data, col=bluescale(64))
install.packages("ClassDiscovery")
source("http://bioinformatics.mdanderson.org/OOMPA/oompaLite.R")
oompaLite()
source("http://silicovore.com/OOMPA/oompaLite.R")
oompaLite()
oompainstall()
library("ClassDiscovery")
data <- matrix(1:1024, nrow=1024)
image(data, col=bluescale(64))
image(data, col=redgreen(32))
image(data, col=redscale(128))
image(data, col=blueyellow(64))
image(data, col=jetColors(64))
image(data, col=blueyellow(64))
blueyellow<-function(n){
col=colorRampPalette(c("white", "red"))(20)
return(color)
}
blueyellow(64)
blueyellow<-function(n){
color=colorRampPalette(c("white", "red"))(20)
return(color)
}
blueyellow(64)
blueyellow<-function(n){
color=colorRampPalette(c("blue", "yellow"))(20)
return(color)
}
blueyellow(64)
blueyellow<-function(n){
color=colorRampPalette(c("blue", "yellow"))(20)
return(color)
}
image(data, col=blueyellow(64))
bluescale
image(data, col=bluescale(64))
blueyellow
jetColors
image(data, col=jetColors(64))
jetColors<-function(N){
k <- ceiling(N/4)
temp.red <- c(rep(0, 2 * k), 1:k, rep(k, k - 1), k:1)
temp.green <- c(rep(0, k), 1:k, rep(k, k - 1), k:1, rep(0,k))
temp.blue <- c(1:k, rep(k, k - 1), k:1, rep(0, 2 * k))
temp.rgb <- cbind(temp.red, temp.green, temp.blue)
delta <- 5 * k - 1 - N
delta <- ceiling(delta/2)
temp.rgb <- temp.rgb[delta:(delta + N - 1), ]/k
color<-rgb(temp.rgb[, 1], temp.rgb[, 2], temp.rgb[, 3])
return(color)
}
image(data, col=jetColors(64))
image(data, col=jetColors(64))
redscale
image(data, col=redscale(128))
redscale<-function(n){
rgb((1:n) - 1, 0, 0, maxColorValue=n)
}
image(data, col=redscale(64))
image(data, col=jetColors(64))
image(data, col=redscale(64))
redscale<-function(n){
rgb((1:n) - 1, 1,1, maxColorValue=n)
}
image(data, col=redscale(64))
redscale<-function(n){
rgb((1:n) - 1, 255,255, maxColorValue=n)
}
image(data, col=redscale(64))
image(data, col=bluescale(64))
whitered<-function(n){
color=colorRampPalette(c("white", "red"))(n)
return(color)
}
image(data, col=whitered(64))
whiteblue<-function(n){
color=colorRampPalette(c("white", "blue"))(n)
return(color)
}
image(data, col=whiteblue(64))
whiteyellow<-function(n){
color=colorRampPalette(c("white", "yellow"))(n)
return(color)
}
image(data, col=whiteyellow(64))
whitebrown<-function(n){
color=colorRampPalette(c("white", "brwon"))(n)
return(color)
}
image(data, col=whitebrown(64))
whitebrown<-function(n){
color=colorRampPalette(c("white", "brown"))(n)
return(color)
}
image(data, col=whitebrown(64))
}
whiteblack<-function(n){
color=colorRampPalette(c("white", "black"))(n)
return(color)
}
image(data, col=whiteblack(64))
image(data, col=whitered(64))
image(data, col=whiteblue(64))
source('~/.active-rstudio-document', echo=TRUE)
? colorRampPalette
col=colorRampPalette(c("white", "red"))(20)
col
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.7,labRow=NA)
library("gplots")
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.7,labRow=NA)
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\phase2\\")
file1<-read.table("WGBS_methHap_load_matrix_July2015.txt",head=T,sep="\t",row.names=1,as.is=T,check.names=F)
file1<-data.matrix(file1[,13:56])  # remove H1 and WBC
colnames(file1)
colnames(file1)<-gsub("_","-",colnames(file1))
colname2<-unlist(lapply(colnames(file1),function(x) unlist(strsplit(x,"[.]"))[1]))
saminfo2<-read.table("newsaminfo.txt",head=T,sep="\t",as.is=T)
saminfo2<-saminfo2[na.omit(match(colname2,saminfo2[,1])),]
colnames(file1)<-saminfo2[,2]
colnames(file1)
group=names(table(colnames(file1)))
index=colnames(file1)
gsi<-c()
gmaxgroup<-c()
for(i in 1:nrow(file1)){
gsit<-0
gmax<-names(which.max(tapply(as.numeric(file1[i,]),index,mean)))
for(j in 1:length(group)){
tmp<-(1-10^(mean(file1[i,][which(index==group[j])]))/10^(mean(file1[i,][which(index==gmax)])))/(length(group)-1)
gsit<-gsit+tmp
}
gmaxgroup<-c(gmaxgroup,gmax)
gsi<-c(gsi,gsit)
print(c(gmax,gsit))
}
rlt=data.frame(region=rownames(file1),group=gmaxgroup,GSI=gsi)
data<-read.table(file="Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",head=T,sep="\t",as.is=T)
# heat only have 3 high GSI regions
sum(table(subset(data,GSI>0.6)[,2]))
head(data)
tissue<-names(table(data[,2]))
choose<-c()
for(i in 1:length(tissue)){
tmp<-subset(data,group==tissue[i])
tmp<-tmp[order(tmp[,3],decreasing=T),]
if(nrow(tmp)>5){
}else{
choose<-c(choose,tmp[1:20,1])
choose<-c(choose,tmp[,1])
}
choose
}
tmp2<-file1[match(choose,rownames(file1)),]
tmp2<-tmp2[,order(colnames(tmp2))]
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.7,labRow=NA)
col=colorRampPalette(c("white", "red"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.7,labRow=NA)
head(tmp2)
data<-read.table(file="Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",head=T,sep="\t",as.is=T)
head(data)
sum(table(subset(data,GSI>0.6)[,2]))
head(data)
tissue<-names(table(data[,2]))
choose<-c()
for(i in 1:length(tissue)){
tmp<-subset(data,group==tissue[i])
tmp<-tmp[order(tmp[,3],decreasing=T),]
if(nrow(tmp)>5){
choose<-c(choose,tmp[1:20,1])
}else{
choose<-c(choose,tmp[,1])
}
choose
}
choose
tmp2<-file1[match(choose,rownames(file1)),]
head(tmp2)
tmp2<-tmp2[,order(colnames(tmp2))]
head(tmp2)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.7,labRow=NA)
col=colorRampPalette(c("green", "red"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.7,labRow=NA)
col=colorRampPalette(c("yellow", "red"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.7,labRow=NA)
col=colorRampPalette(c("grey", "red"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.7,labRow=NA)
col=colorRampPalette(c("white", "red"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.7,labRow=NA)
col=colorRampPalette(c("white", "red"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.7,labRow=NA)
col=colorRampPalette(c("white", "red"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.7,labRow=NA)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.9,labRow=NA)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.8,labRow=NA)
col=colorRampPalette(c("white", "red"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.8,labRow=NA)
col=colorRampPalette(c("white", "red"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.8,labRow=NA)
col=colorRampPalette(c("yellow", "red"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.8,labRow=NA)
image(data, col=blueyellow(64))
data
image(matrix(1:1024, nrow=1024), col=blueyellow(64))
image(matrix(1:1024, nrow=1024), col=yellowblue(64))
whiteblack<-function(n){
color=colorRampPalette(c("yellow", "blue"))(n)
return(color)
}
image(matrix(1:1024, nrow=1024), col=yellowblue(64))
yellowblue<-function(n){
color=colorRampPalette(c("yellow", "blue"))(n)
}
return(color)
yellowblue<-function(n){
color=colorRampPalette(c("yellow", "blue"))(n)
return(color)
}
image(matrix(1:1024, nrow=1024), col=yellowblue(64))
col=colorRampPalette(c("blue", "yellow"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.8,labRow=NA)
col=colorRampPalette(c("yellow", "blue"))(20)
heatmap.2(tmp2,col=col,trace="none",density.info="none",Colv=F,Rowv=F,key=T,keysize=1,cexCol=0.8,labRow=NA)
names(table(data[,2]))
