coord_cartesian(ylim = c(0, 18))+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"))
# methylation circle plot
hapinfo_matrix <- data.frame(CpG=rep(1:4,16), read=rep(1:16, each=4), value=c(rep(1,32),rep(16,32)))
library("ggplot2")
ggplot() +
scale_shape_identity() +
geom_point(data=hapinfo_matrix, aes(x=CpG, y=read, shape=value), size=7)+
coord_cartesian(ylim = c(0, 18))+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"))
cor(t(matrix[,1]))
matrix<-data.matrix(data.frame(hap2matrix(hapinfo)))
matrix
t(matrix[,1])
cor(t(matrix))
lower.tri(cor(t(matrix)))
matrix[lower.tri(cor(t(matrix)))]
cor(t(matrix))[lower.tri(cor(t(matrix)))]
cor(t(matrix))
cor(t(matrix))
mean(cor(t(matrix))[lower.tri(cor(t(matrix)))])
matrix<-data.matrix(data.frame(hap2matrix(hapinfo)),na.rm=T)
matrix<-data.matrix(data.frame(hap2matrix(hapinfo)),na.omit=T)
matrix<-data.matrix(data.frame(hap2matrix(hapinfo)))
cor(t(matrix))
cor(t(matrix))[lower.tri(cor(t(matrix)))]
cor[lower.tri(cor)]<-NA
cor[lower.tri(cor)]
cor<-cor(t(matrix))
cor[lower.tri(cor)]
cor[lower.tri(cor)]<-NA
cor
cor[lower.tri(cor,diag=T)]<-NA
cor
cor<-cor(t(matrix))
cor[lower.tri(cor,diag=T)]<-NA
cor
mean(cor,na.rm=T)
sum(cor,na.rm=T)
cor<-as.vector(cor)
cor
cor<-na.omit(as.vector(cor))
cor
mean(cor)
matrix<-data.matrix(data.frame(hap2matrix(hapinfo)))
matrix
matrix<-matrix-1
cor<-cor(t(matrix))
cor[lower.tri(cor,diag=T)]<-NA
cor<-na.omit(as.vector(cor))
mean(cor)
hapinfo<-c(rep("CCTT",8),rep("CCTT",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c(rep("CCTT",8),rep("CCTT",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
#######################################################################################################################
###   Title : Methylation haplotype load, absolute methylation level and methylation entropy
###   Lab:  Kun's Lab (http://zhang.openwetware.org/)
###   Time :  Sep/29/2015
###   Update: re-define MHL to identify continous long methylation and non-methylation reads
#######################################################################################################################
library("entropy")
methentropy<-function(hapinfo){
entropy<-entropy(table(hapinfo),unit="log2")/nchar(hapinfo[1])
return(entropy)
}
hap2methfreq<-function(hapinfo){
hapinfo<-paste(hapinfo,collapse="")
hapinfo<-strsplit(hapinfo,"")
num_C<-length(grep("C",unlist(hapinfo)))
num_T<-length(grep("T",unlist(hapinfo)))
methfreq<-  num_C/(num_C+num_T)
return(methfreq)
}
hap_comb_tmp<-function(hapinfo.single){
# hap_com.single is a character of haplotype, such as "TCTCTT"
hap_com.single<-c()
hapinfo.single<-as.character(hapinfo.single)
for(i in 1:nchar(hapinfo.single)){
for(j in i:(nchar(hapinfo.single))){
hap_com.single<-c(hap_com.single,(substr(hapinfo.single,i,j)))
}
}
return(hap_com.single)
}
hap_comb<-function(hapinfo){
# haplotype is array of observed methylation haplotype
hapinfo<-as.list(hapinfo)
hap_comb<-unlist(lapply(hapinfo,hap_comb_tmp))
return(hap_comb)
}
mhl<-function(hap_comb_array){
# hap_comb_array is combinarial methylation haplotype
mhl_value<-c()
hap_comb_array<-unlist(hap_comb_array)
meth_hap=lapply(lapply(hap_comb_array,function(x) unique(unlist(strsplit(x,"")))),function(x) paste(x,collapse=""))=="C"
unmeth_hap=lapply(lapply(hap_comb_array,function(x) unique(unlist(strsplit(x,"")))),function(x) paste(x,collapse=""))=="T"
hap_comb_array.CG<-c(hap_comb_array[meth_hap],hap_comb_array[unmeth_hap])
for(i in unique(nchar(hap_comb_array.CG))){
input_tmp<-which(nchar(hap_comb_array.CG)==i)
nmeth<-length(grep(paste(rep("C",i),collapse=""),hap_comb_array.CG[input_tmp]))
nunmeth<-length(grep("T",hap_comb_array.CG[input_tmp]))
mhl_value<-c(mhl_value,i*(nmeth)/sum(nchar(hap_comb_array)==i))
print(sum(nchar(hap_comb_array)==i))
}
mhl_value<-sum(mhl_value)/sum(unique(nchar(hap_comb_array)))
return(mhl_value)
}
hapinfo<-c(rep("CCCC",8),rep("CCCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c(rep("TTTT",8),rep("TTTT",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c(rep("CCCC",8),rep("TTTT",8))
mhl_rlt<-mhl(hap_comb((hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c(rep("CCCC",8),rep("CCCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c(rep("CCCC",8),rep("TTTT",8))
mhl_rlt<-mhl(hap_comb((hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c("TCCT","TTTC","CTTC","CTCT" ,"TTCC", "CTTT", "CCTT" ,"TTCT" ,"CCCC" ,"CCTC" ,"TCTT" ,"TTTT" ,"CTCC", "TCTC", "TCCC" ,"CCCT")
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c(rep("CCTT",8),rep("TTCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
# scenarioE MHL=0.23, AML= 0.5     # mhl:(1/10+8/60)
hapinfo<-c(rep("CCTT",8),rep("TTCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
# scenarioF MHL=0.11, AML= 0.5
hapinfo<-c(rep("CCTT",8),rep("CCTT",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c(rep("CCTT",8),rep("TTCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c(rep("CCTT",8),rep("CCTT",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c(rep("CCTT",8),rep("TTCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c("TCCT","TTTC","CTTC","CTCT" ,"TTCC", "CTTT", "CCTT" ,"TTCT" ,"CCCC" ,"CCTC" ,"TCTT" ,"TTTT" ,"CTCC", "TCTC", "TCCC" ,"CCCT")
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c(rep("CCTT",8),rep("TTCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
hapinfo<-c(rep("CCCC",8),rep("CCCC",8))
View(hapinfo_matrix)
View(hapinfo_matrix)
hapinfo<-c(rep("CCCC",8),rep("CCCC",8))
# scenarioA MHL=1, AML= 1     # mhl:(1/10+8/60)
hapinfo<-c(rep("CCCC",8),rep("CCCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="1.txt")
# scenarioB MHL=0, AML= 0     # mhl:(1/10+8/60)
hapinfo<-c(rep("TTTT",8),rep("TTTT",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="2.txt")
# scenarioC MHL=0.5, AML= 0.5
hapinfo<-c(rep("CCCC",8),rep("TTTT",8))
mhl_rlt<-mhl(hap_comb((hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="3.txt")
# scenarioD MHL=0.1625, AML= 0.5
hapinfo<-c("TCCT","TTTC","CTTC","CTCT" ,"TTCC", "CTTT", "CCTT" ,"TTCT" ,"CCCC" ,"CCTC" ,"TCTT" ,"TTTT" ,"CTCC", "TCTC", "TCCC" ,"CCCT")
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="4.txt")
# scenarioE MHL=0.23, AML= 0.5     # mhl:(1/10+8/60)
hapinfo<-c(rep("CCTT",8),rep("TTCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="5.txt")
# scenarioF MHL=0.11, AML= 0.5
hapinfo<-c(rep("CCTT",8),rep("CCTT",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="6.txt")
getwd()
# scenarioA MHL=1, AML= 1     # mhl:(1/10+8/60)
hapinfo<-c(rep("CCCC",8),rep("CCCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="1.txt",quote=F)
# scenarioB MHL=0, AML= 0     # mhl:(1/10+8/60)
hapinfo<-c(rep("TTTT",8),rep("TTTT",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="2.txt",quote=F)
# scenarioC MHL=0.5, AML= 0.5
hapinfo<-c(rep("CCCC",8),rep("TTTT",8))
mhl_rlt<-mhl(hap_comb((hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="3.txt",quote=F)
# scenarioD MHL=0.1625, AML= 0.5
hapinfo<-c("TCCT","TTTC","CTTC","CTCT" ,"TTCC", "CTTT", "CCTT" ,"TTCT" ,"CCCC" ,"CCTC" ,"TCTT" ,"TTTT" ,"CTCC", "TCTC", "TCCC" ,"CCCT")
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="4.txt",quote=F)
# scenarioE MHL=0.23, AML= 0.5     # mhl:(1/10+8/60)
hapinfo<-c(rep("CCTT",8),rep("TTCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="5.txt",quote=F)
# scenarioF MHL=0.11, AML= 0.5
hapinfo<-c(rep("CCTT",8),rep("CCTT",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="6.txt",quote=F)
write.table(data.frame(hapinfo),file="1.txt",quote=F)
? write.table
write.table(data.frame(hapinfo),file="1.txt",quote=F)
write.table(data.frame(hapinfo),file="1.txt",quote="F")
#######################################################################################################################
###   Title : Methylation haplotype load, absolute methylation level and methylation entropy
###   Lab:  Kun's Lab (http://zhang.openwetware.org/)
###   Time :  Sep/29/2015
###   Update: re-define MHL to identify continous long methylation and non-methylation reads
#######################################################################################################################
library("entropy")
methentropy<-function(hapinfo){
entropy<-entropy(table(hapinfo),unit="log2")/nchar(hapinfo[1])
return(entropy)
}
hap2methfreq<-function(hapinfo){
hapinfo<-paste(hapinfo,collapse="")
hapinfo<-strsplit(hapinfo,"")
num_C<-length(grep("C",unlist(hapinfo)))
num_T<-length(grep("T",unlist(hapinfo)))
methfreq<-  num_C/(num_C+num_T)
return(methfreq)
}
hap_comb_tmp<-function(hapinfo.single){
# hap_com.single is a character of haplotype, such as "TCTCTT"
hap_com.single<-c()
hapinfo.single<-as.character(hapinfo.single)
for(i in 1:nchar(hapinfo.single)){
for(j in i:(nchar(hapinfo.single))){
hap_com.single<-c(hap_com.single,(substr(hapinfo.single,i,j)))
}
}
return(hap_com.single)
}
hap_comb<-function(hapinfo){
# haplotype is array of observed methylation haplotype
hapinfo<-as.list(hapinfo)
hap_comb<-unlist(lapply(hapinfo,hap_comb_tmp))
return(hap_comb)
}
mhl<-function(hap_comb_array){
# hap_comb_array is combinarial methylation haplotype
mhl_value<-c()
hap_comb_array<-unlist(hap_comb_array)
meth_hap=lapply(lapply(hap_comb_array,function(x) unique(unlist(strsplit(x,"")))),function(x) paste(x,collapse=""))=="C"
unmeth_hap=lapply(lapply(hap_comb_array,function(x) unique(unlist(strsplit(x,"")))),function(x) paste(x,collapse=""))=="T"
hap_comb_array.CG<-c(hap_comb_array[meth_hap],hap_comb_array[unmeth_hap])
for(i in unique(nchar(hap_comb_array.CG))){
input_tmp<-which(nchar(hap_comb_array.CG)==i)
nmeth<-length(grep(paste(rep("C",i),collapse=""),hap_comb_array.CG[input_tmp]))
nunmeth<-length(grep("T",hap_comb_array.CG[input_tmp]))
mhl_value<-c(mhl_value,i*(nmeth)/sum(nchar(hap_comb_array)==i))
print(sum(nchar(hap_comb_array)==i))
}
mhl_value<-sum(mhl_value)/sum(unique(nchar(hap_comb_array)))
return(mhl_value)
}
###############################################################################################################################
### methylation haplotype load for the Different situation/haplotypes (6 situation) AML: absolute methylation level (average)
###############################################################################################################################
# scenarioA MHL=1, AML= 1     # mhl:(1/10+8/60)
hapinfo<-c(rep("CCCC",8),rep("CCCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="1.txt")
? write.table
# scenarioB MHL=0, AML= 0     # mhl:(1/10+8/60)
hapinfo<-c(rep("TTTT",8),rep("TTTT",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="2.txt",quote=F)
# scenarioC MHL=0.5, AML= 0.5
hapinfo<-c(rep("CCCC",8),rep("TTTT",8))
mhl_rlt<-mhl(hap_comb((hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="3.txt",quote=F)
# scenarioD MHL=0.1625, AML= 0.5
hapinfo<-c("TCCT","TTTC","CTTC","CTCT" ,"TTCC", "CTTT", "CCTT" ,"TTCT" ,"CCCC" ,"CCTC" ,"TCTT" ,"TTTT" ,"CTCC", "TCTC", "TCCC" ,"CCCT")
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="4.txt",quote=F)
# scenarioE MHL=0.23, AML= 0.5     # mhl:(1/10+8/60)
hapinfo<-c(rep("CCTT",8),rep("TTCC",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="5.txt",quote=F)
# scenarioF MHL=0.11, AML= 0.5
hapinfo<-c(rep("CCTT",8),rep("CCTT",8))
mhl_rlt<-mhl(hap_comb(unique(hapinfo)))
aml_rlt<-hap2methfreq(hapinfo)
mhl_rlt
aml_rlt
write.table(data.frame(hapinfo),file="6.txt",quote=F)
write.table(data.frame(hapinfo),file="1.txt")
write.table(data.frame(hapinfo),file="1.txt",quote=F)
hapinfo
data.frame(hapinfo)
write.table(data.frame(hapinfo),file="1.txt",quote=F,col.names=F,row.names=F)
write.table(data.frame(hapinfo),file="1.txt",col.names=F,row.names=F)
1885+69+5
690+69/3+5/3
690*2+69/3+5/3
690+69/3+5/3
690+68/3+5/3
690+69/3+5/3
690*2+68/3+5/3
690*2+69/3+5/3
715*6.3
715*6.4
715*6.35
715*6.36
690*2
1885-1380
1405-50
setwd("/home/shg047/monod/oct/data")
saminfo3
28+17
59+39
98/2
59.3/12+38.7/2+25/2+25
59.3/2+25
(59.3/2+25)*25/31
file2<-read.table("/home/sguo/monod/phase2/150209_BSPP_mld_blocks_stringent_mhl_matrix.txt",head=T,sep="\t",row.names=1,as.is=T,check.names=F)
x<-matrix(rnorm(1000,100,10),100,10)
heatmap.2(as.matrix(x), col=colorRampPalette(c("steelblue1","purple"))(16), scale="none", cexCol=1.0, cexRow=0.2, trace="row", tracecol="grey", dendrogram="none", Rowv=FALSE,Colv=FALSE,key=F)
library(gplots)
heatmap.2(as.matrix(x), col=colorRampPalette(c("steelblue1","purple"))(16), scale="none", cexCol=1.0, cexRow=0.2, trace="row", tracecol="grey", dendrogram="none", Rowv=FALSE,Colv=FALSE,key=F)
x<-matrix(rnorm(1000,10,100),100,10)
x=read.table("tmp_hapMatrix.txt",header=TRUE,row.names=1);
heatmap.2(as.matrix(x), col=colorRampPalette(c("steelblue1","purple"))(16), scale="none", cexCol=1.0, cexRow=0.2, trace="row", tracecol="grey", dendrogram="none", Rowv=FALSE,Colv=FALSE,key=F)
setwd("C:\\Users\\shicheng\\Downloads\\")
setwd("C:\\Users\\shicheng\\Downloads\\")
data<-read.table("Table.GSI.WGBS.Remove.H1.WBC.rlt.txt")
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\src")
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\src\\")
data<-read.table("Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",sep="\t")
head(data)
data<-read.table("Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",sep="\t",head=T)
head(data)
hist(data$GSI)
hist(data$GSI,break=100)
hist(data$GSI,breaks=100)
hist(data$GSI,breaks=50)
hist(data$GSI,breaks=20)
hist(data$GSI,breaks=10)
hist(data$GSI,breaks=20)
density(data$GSI,breaks=20)
plot(density(data$GSI))
hist(data$GSI,breaks=20)
hist(data$GSI,breaks=50)
hist(data$GSI,breaks=10)
hist(data$GSI,breaks=15)
hist(data$GSI,breaks=75)
hist(data$GSI,breaks=200)
head(data)
hist(data$GSI,breaks=200)
plot(density(data$GSI))
hist(data$GSI,breaks=200)
data<-read.table("Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",sep="\t",head=T)
head(data)
hist(data$GSI,breaks=200)
data<-read.table("Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",sep="\t",head=T)
head(data)
hist(data$GSI,breaks=200)
1/200
data<-read.table("Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",sep="\t",head=T)
head(data)
hist(data$GSI,breaks=200)
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\src\\")
data<-read.table("Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",sep="\t",head=T)
head(data)
hist(data$GSI,breaks=200)
1/200
head(data)
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\src\\")
data<-read.table("Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",sep="\t",head=T)
head(data)
hist(data$GSI,breaks=200)
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\src\\")
data<-read.table("Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",sep="\t",head=T)
head(data)
hist(data$GSI,breaks=200)
hist(data$GSI,breaks=200,ylim=c(0,400))
hist(data$GSI,breaks=200,ylim=c(0,300))
hist(data$GSI,breaks=200)
hist(data$GSI,breaks=200)
hist(data$GSI,breaks=200,xlab="GSI")
hist(data$GSI,breaks=200,xlab="GSI",main="")
hist(data$GSI,breaks=200,xlab="GSI",main="")
hist(data$GSI,breaks=200,xlab="GSI",main="",col="red")
read.table("saminfo.txt",sep="\t")
setwd("C:\\Users\\shicheng\\Dropbox\\Project\\methylation\\monod\\src\\")
data<-read.table("Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",sep="\t",head=T)
head(data)
subset(data,GSI>0.6)
subset(data,GSI>0.65)
data<-read.table("Table.GSI.WGBS.Remove.H1.WBC.rlt.txt",sep="\t",head=T)
head(data)
subset(data,GSI>0.65)
subset(data,GSI>0.6)
hist(data$GSI,breaks=200,xlab="GSI",main="",col="red",fill="red")
? hist
hist(data$GSI,breaks=200,xlab="GSI",main="",col="red")
hist(data$GSI,breaks=200,xlab="GSI",main="",col="red",ylim=c(0,400))
hist(data$GSI,breaks=200,xlab="GSI",main="",col="red",ylim=c(0,300))
hist(data$GSI,breaks=200,xlab="GSI",main="",col="red",ylim=c(0,200))
hist(data$GSI,breaks=100,xlab="GSI",main="",col="red",ylim=c(0,200))
hist(data$GSI,breaks=100,xlab="GSI",main="",col="red",ylim=c(0,300))
hist(data$GSI,breaks=100,xlab="GSI",main="",col="red",ylim=c(0,400))
gsi<-subset(data,GSI>0.6)
gsi<-subset(data,GSI>0.6)
table(gsi$group)
table(gsi$group)
data.frame(table(gsi$group))
gsi<-subset(data,GSI>0.5)
data.frame(table(gsi$group))
gsi<-subset(data,GSI>0.5)
dim(gsi)
write.table(data.frame(table(gsi$group))),file="supplementary.table.gsi.tissue.number.txt",col.names=F,row.names=F,quote=F,sep="\t")
write.table(data.frame(table(gsi$group)),file="supplementary.table.gsi.tissue.number.txt",col.names=F,row.names=F,quote=F,sep="\t")
write.table(data.frame(table(gsi$group)),file="supplementary.table.gsi.tissue.number.txt"sep="\t")
write.table(data.frame(table(gsi$group)),file="supplementary.table.gsi.tissue.number.txt",sep="\t")
getwd()
top<-order(fit$importance[,6],decreasing=T)[1:100]
6/8
7/8
seq(1,1688,by=4)
