data<-set1
con1<-length(data[data$pheno==0 & data$ID04<1.65,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>1.65 & data$ID04<2.35,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>2.35,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<1.65,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>1.65 & data$ID04<2.35,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>2.35,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set2
con1<-length(data[data$pheno==0 & data$ID04<1.65,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>1.65 & data$ID04<2.35,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>2.35,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<1.65,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>1.65 & data$ID04<2.35,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>2.35,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set
con1<-length(data[data$pheno==0 & data$ID04<1.65,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>1.65 & data$ID04<2.35,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>2.35,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<1.65,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>1.65 & data$ID04<2.35,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>2.35,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
threshold1<-1.65
threshold2<-2.35
threshold1<-1.5
threshold2<-2.5
set<-rbind(set1,set2)
data<-set1
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
threshold1<-1.25
threshold2<-2.25
set<-rbind(set1,set2)
data<-set1
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set2
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
threshold1<-1.65   #1.65
threshold2<-2.35   #2.35
set<-rbind(set1,set2)
data<-set1
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set2
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
threshold1<-1.75   #1.65
threshold2<-2.35   #2.35
set<-rbind(set1,set2)
data<-set1
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set2
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
threshold1<-1.65   #1.65
threshold2<-2.35   #2.35
set<-rbind(set1,set2)
data<-set1
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set2
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
t1<-summary(glm(pheno~ID02+gender,data=set1,family=binomial(logit)))
t2<-summary(glm(pheno~ID04+gender,data=set1,family=binomial(logit)))
t3<-summary(glm(pheno~ID02+gender,data=set2,family=binomial(logit)))
t4<-summary(glm(pheno~ID04+gender,data=set2,family=binomial(logit)))
t5<-summary(glm(pheno~ID02+gender,data=set,family=binomial(logit)))
t6<-summary(glm(pheno~ID04+gender,data=set,family=binomial(logit)))
t1
threshold1<-1.75   #1.65
threshold2<-2.25   #2.35
set<-rbind(set1,set2)
data<-set1
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set2
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
threshold1<-1.75   #1.65
threshold2<-2.25   #2.35
set<-rbind(set1,set2)
data<-set1
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set2
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
threshold1<-1.75   #1.65
threshold2<-2.25   #2.35
set<-rbind(set1,set2)
data<-set1
con1<-length(data[data$pheno==0 & data$ID02<threshold1,]$ID02)
con2<-length(data[data$pheno==0 & data$ID02>threshold1 & data$ID02<threshold2,]$ID02)
con3<-length(data[data$pheno==0 & data$ID02>threshold2,]$ID02)
case1<-length(data[data$pheno==1 & data$ID02<threshold1,]$ID02)
case2<-length(data[data$pheno==1 & data$ID02>threshold1 & data$ID02<threshold2,]$ID02)
case3<-length(data[data$pheno==1 & data$ID02>threshold2,]$ID02)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set2
con1<-length(data[data$pheno==0 & data$ID02<threshold1,]$ID02)
con2<-length(data[data$pheno==0 & data$ID02>threshold1 & data$ID02<threshold2,]$ID02)
con3<-length(data[data$pheno==0 & data$ID02>threshold2,]$ID02)
case1<-length(data[data$pheno==1 & data$ID02<threshold1,]$ID02)
case2<-length(data[data$pheno==1 & data$ID02>threshold1 & data$ID02<threshold2,]$ID02)
case3<-length(data[data$pheno==1 & data$ID02>threshold2,]$ID02)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
data<-set
con1<-length(data[data$pheno==0 & data$ID02<threshold1,]$ID02)
con2<-length(data[data$pheno==0 & data$ID02>threshold1 & data$ID02<threshold2,]$ID02)
con3<-length(data[data$pheno==0 & data$ID02>threshold2,]$ID02)
case1<-length(data[data$pheno==1 & data$ID02<threshold1,]$ID02)
case2<-length(data[data$pheno==1 & data$ID02>threshold1 & data$ID02<threshold2,]$ID02)
case3<-length(data[data$pheno==1 & data$ID02>threshold2,]$ID02)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
# plot the distribution
data<-rbind(set1,set2)
pdf("cnvdistribution.pdf")
par(mfrow=c(2,1))
plot(density(data$ID02[which(data$pheno==1)],na.rm=T),lty=1,col="red",main="CNV Distribution of HLA-DRB5",xlab="Copy number of HLA-DRB5")
lines(density(data$ID02[which(data$pheno==0)],na.rm=T),lty=2,col="green")
legend("topright",legend=c("AS(394)","Control(423)"),col=c("red","green"),lty=c(1,2))
plot(density(data$ID04[which(data$pheno==0)],na.rm=T),lty=2,col="green",main="CNV Distribution of HLA-DQA1",xlab="Copy number of HLA-DQA1")
lines(density(data$ID04[which(data$pheno==1)],na.rm=T),lty=1,col="red")
legend("topleft",legend=c("AS(394)","Control(423)"),col=c("red","green"),lty=c(1,2))
dev.off()
table(data$pheno)
pdf("cnvdistribution.pdf")
par(mfrow=c(2,1))
plot(density(data$ID02[which(data$pheno==1)],na.rm=T),lty=1,col="red",main="CNV Distribution of HLA-DRB5",xlab="Copy number of HLA-DRB5")
lines(density(data$ID02[which(data$pheno==0)],na.rm=T),lty=2,col="green")
legend("topright",legend=c("AS(533)","Control(792)"),col=c("red","green"),lty=c(1,2))
plot(density(data$ID04[which(data$pheno==0)],na.rm=T),lty=2,col="green",main="CNV Distribution of HLA-DQA1",xlab="Copy number of HLA-DQA1")
lines(density(data$ID04[which(data$pheno==1)],na.rm=T),lty=1,col="red")
legend("topleft",legend=c("AS(533)","Control(792)"),col=c("red","green"),lty=c(1,2))
dev.off()
set2case<-dim(set2[set2$pheno==1,])[1]
set2control<-dim(set2[set2$pheno==0,])[1]
matrix(c(set1case,set1control,set2case,set2control),2,byrow=T)
data<-set
con1<-length(data[data$pheno==0 & data$ID04<threshold1,]$ID04)
con2<-length(data[data$pheno==0 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
con3<-length(data[data$pheno==0 & data$ID04>threshold2,]$ID04)
case1<-length(data[data$pheno==1 & data$ID04<threshold1,]$ID04)
case2<-length(data[data$pheno==1 & data$ID04>threshold1 & data$ID04<threshold2,]$ID04)
case3<-length(data[data$pheno==1 & data$ID04>threshold2,]$ID04)
sta<-(matrix(c(con1,con2,con3,case1,case2,case3),2,3,byrow=T))
colnames(sta)<-c("less","equal","more")
rownames(sta)<-c("control","case")
prop.trend.test(sta[1,],colSums(sta))
sta
sta[1,]/533
sta[2,]/533
sta[1,]/792
matrix(sta[1,1],sta[1,2],sta[2,1],sta[2,2],2,2)
matrix(sta[1,1],sta[1,2],sta[2,1],sta[2,2],2,2)
sta
matrix(c(sta[1,1],sta[1,2],sta[2,1],sta[2,2]),2,2)
matrix(c(sta[1,1],sta[1,2],sta[2,1],sta[2,2]),2,2)
tmp1<-matrix(c(sta[1,1],sta[1,2],sta[2,1],sta[2,2]),2,2)
tmp2<-matrix(c(sta[1,2],sta[1,3],sta[2,2],sta[2,3],),2,2)
tmp2<-matrix(c(sta[1,2],sta[1,3],sta[2,2],sta[2,3],),2,2)
tmp2<-matrix(c(sta[1,2],sta[1,3],sta[2,2],sta[2,3]),2,2)
chisq.test(tmp1)
chisq.test(tmp1)
chisq.test(tmp2)
library(epitools)
library("epitools")
install.packages("epitools")
library("epitools")
tmp1<-matrix(c(sta[1,1],sta[1,2],sta[2,1],sta[2,2]),2,2)
tmp2<-matrix(c(sta[1,2],sta[1,3],sta[2,2],sta[2,3]),2,2)
oddsratio(tmp1)
t冒泡
tmp1
oddsratio(t(tmp1))
tmp1
tmp1<-matrix(c(sta[1,1],sta[1,2],sta[2,1],sta[2,2]),2,2)
tmp1
tmp1<-matrix(c(sta[2,1],sta[2,2],sta[1,1],sta[1,2]),2,2)
oddsratio(tmp1))
oddsratio(tmp1)
tmp2<-matrix(c(sta[2,2],sta[2,3],sta[1,2],sta[1,3]),2,2)
oddsratio(tmp2)
tmp2<-matrix(c(sta[2,3],sta[2,2],sta[1,3],sta[1,2]),2,2)
oddsratio(tmp2)
head(data)
data$gender<-as.character(data$gender)
data$gender[data$gender=="M"]<-"1"
data$gender[data$gender=="F"]<-"0"
data$gender<-as.factor(data$gender)
summary(glm(pheno~ID04+gender+age,data=data,family=binomial(logit)))
data$gender<-as.factor(data$gender)
summary(glm(pheno~ID04+gender+age,data=data,family=binomial(logit)))
colnames(data)
head(data)
data$gender<-as.character(data$gender)
data$gender[data$gender=="M"]<-"1"
data$gender[data$gender=="F"]<-"0"
data$gender<-as.factor(data$gender)
summary(glm(pheno~ID04+gender+age,data=data,family=binomial(logit)))
data$gender<-as.numeric(data$gender)
summary(glm(pheno~ID04+gender+age,data=data,family=binomial(logit)))
sum.coef<-summary(glm(pheno~ID04+gender,data=set,family=binomial(logit)))
lower.ci<-exp(sum.coef$coefficients[,1]+1.96*sum.coef$coefficients[,2])
upper.ci<-exp(sum.coef$coefficients[,1]-1.96*sum.coef$coefficients[,2])
fit<-round(exp(sum.coef$coefficients[,1])[2],2)
low<-round(lower.ci[2],2)
up<-round(upper.ci[2],2)
pvalue<-sum.coef$coefficients[2,4]
paste(fit,"(",up,"-",low,")","  ",pvalue,sep="")
set
head(set)
sum.coef<-summary(glm(pheno~ID04+gender,data=set,family=binomial(logit)))
lower.ci<-exp(sum.coef$coefficients[,1]+1.96*sum.coef$coefficients[,2])
upper.ci<-exp(sum.coef$coefficients[,1]-1.96*sum.coef$coefficients[,2])
fit<-round(exp(sum.coef$coefficients[,1])[2],2)
low<-round(lower.ci[2],2)
up<-round(upper.ci[2],2)
pvalue<-sum.coef$coefficients[2,4]
paste(fit,"(",up,"-",low,")","  ",pvalue,sep="")
? lappy
? lappy
? lapply
? apply
setwd("/home/gsc/Dropbox/Project/methylation/array")
file<-list.files("funcPCA_score.txt")
file
file<-list.files("*funcPCA_score.txt")
file
file<-list.files(".funcPCA_score.txt")
file
? list.files
file<-list.files(".txt")
file
file<-list.files("txt")
file
file<-list.files(pattern="txt")
file
file<-list.files(pattern="funcPCA_score.txt")
file
i<-1
dat<-read.table(file[i],head=T,sep="\t",row.names=1)
sd(dat)
dat[1,1]
? sd
apply(dat,2, sd)
plot(hist(sd))
sd<-apply(dat,2, sd)
sd
sd[1]
sd[2]
sd2<-apply(dat,2, sd)
plot(hist(sd2))
dat[,1:5]
x<-matrix(rnorm(1024),nrow=32)
# simulate a correlation matrix with values -0.5 to 0.5
x<-rescale(x,c(-0.5,0.5))
# add a column with the extreme values (-1,1) to calculate
# the colors, then drop the extra column in the result
cellcol<-color.scale(cbind(x,c(-1,rep(1,31))),c(0,1),0,c(1,0))[,1:32]
color2D.matplot(x,cellcolors=cellcol,main="Blue to red correlations")
library("skmeans")
library("plotrix")
library("knitr")
library("fpc")
install.packages("plotrix")
x<-matrix(rnorm(1024),nrow=32)
# simulate a correlation matrix with values -0.5 to 0.5
x<-rescale(x,c(-0.5,0.5))
install.packages("knitr")
install.packages("knitr")
install.packages("skmeans")
library("plotrix")
library("skmeans")
library("knitr")
x<-matrix(rnorm(1024),nrow=32)
# simulate a correlation matrix with values -0.5 to 0.5
x<-rescale(x,c(-0.5,0.5))
# add a column with the extreme values (-1,1) to calculate
# the colors, then drop the extra column in the result
cellcol<-color.scale(cbind(x,c(-1,rep(1,31))),c(0,1),0,c(1,0))[,1:32]
color2D.matplot(x,cellcolors=cellcol,main="Blue to red correlations")
# do the legend call separately to get the full range
color.legend(0,-4,10,-3,legend=c(-1,-0.5,0,0.5,1),
rect.col=color.scale(c(-1,-0.5,0,0.5,1),c(0,1),0,c(1,0)),align="rb")
x<-matrix(rnorm(100),nrow=10)
color.legend(0,-4,10,-3,legend=c(-1,-0.5,0,0.5,1),rect.col=color.scale(c(-1,-0.5,0,0.5,1),c(0,1),0,c(1,0)),align="rb")
x<-matrix(rnorm(100),nrow=10)
# Subfunction
color2D.matplot(x,cellcolors=cellcol,main="Blue to red correlations")
x<-matrix(rnorm(1024),nrow=32)
# simulate a correlation matrix with values -0.5 to 0.5
x<-rescale(x,c(-0.5,0.5))
# add a column with the extreme values (-1,1) to calculate
# the colors, then drop the extra column in the result
cellcol<-color.scale(cbind(x,c(-1,rep(1,31))),c(0,1),0,c(1,0))[,1:32]
color2D.matplot(x,cellcolors=cellcol,main="Blue to red correlations")
# do the legend call separately to get the full range
color.legend(0,-4,10,-3,legend=c(-1,-0.5,0,0.5,1),rect.col=color.scale(c(-1,-0.5,0,0.5,1),c(0,1),0,c(1,0)),align="rb")
library("grDevices")
col=colorRampPalette(c("white", "red"))(20)
M <- matrix(runif(400),20,20)
M[lower.tri(M)] <- NA
M[M>0.2]<-1
image(M,col = col,frame=F,xaxt="n",yaxt="n")
