rep<-read.table("repsample.txt",sep="\t",as.is=F)
dat<-read.table("total.out.txt",sep="\t",as.is=F,head=T)
table(dat[,1])
sort(table(dat[,1]))
rep
match(rep[,2],dat[,1])
colnames(dat)[match(rep[,2],dat[,1])]=rep[,2]
colnames(dat)[match(rep[,2],dat[,1])]=array(rep[,2])
rownames(dat)[match(rep[,2],dat[,1])]<-rep[,2]
rownames(dat)[match(rep[,2],dat[,1])]
dat[match(rep[,2],dat[,1]),1]<-rep[,2]
dat[match(rep[,2],dat[,1]),1]<-rep[,2]
sort(table(dat[,1]))
dat[,1]
setwd("/home/gsc/Dropbox/CNV/accucopy")
rep<-read.table("repsample.txt",sep="\t",as.is=F)
dat<-read.table("total.out.txt",sep="\t",as.is=F,head=T)
#note,repeat record for same sample while same sample with different name
sort(table(dat[,1]))
dat[match(rep[,2],dat[,1]),1]<-rep[,2]
sort(table(dat[,1]))
match(rep[,2],dat[,1])
dat[969,1]
dat<-read.table("total.out.txt",sep="\t",as.is=F,head=T)
dat[,969]
dat[969,1]
dat<-read.table("total.out.txt",sep="\t",as.is=F,head=T)
dat[969,1]
head(rep)
rep<-read.table("repsample.txt",sep="\t",as.is=F)
dat<-read.table("total.out.txt",sep="\t",as.is=F,head=T)
#note,repeat record for same sample while same sample with different name
dat[match(rep[,1],dat[,1]),1]<-rep[,2]
sort(table(dat[,1]))
write.table(dat,file="data.txt",sep="\t",quote=F)
x<-sort(table(dat[,1]))
names(x)
names(x==2)
which(x==2)
x
which(x==2)
names(which(x==2))
array(names(which(x==2)))
match(dat[,1],array(names(which(x==2))))
match(dat[,1],array(names(which(x==2))))
match(dat[,1],array(names(which(x>=2))))
!is.na(match(dat[,1],array(names(which(x>=2)))))
nonrepeat<-dat[!is.na(match(dat[,1],array(names(which(x>=2))))),]
repeat<-dat[!is.na(match(dat[,1],array(names(which(x>=2))))),]
repeat<-dat[!is.na(match(dat[,1],array(names(which(x>=2))))),]
repeat<-dat[!is.na(match(dat[,1],array(names(which(x>=2))))),]
repeatdata<-dat[!is.na(match(dat[,1],array(names(which(x>=2))))),]
dim(repeatdata)
write.table(repeatdata,file="repeat.dat",sep="\t",as.is=F,quote=F)
write.table(repeatdata,file="repeat.dat",sep="\t",quote=F)
setwd("/home/gsc/Dropbox/CNV/AS/dat")
d1<-read.table("As_old.txt",head=T,sep="\t",as.is=F)
d2<-read.table("total.new.txt",head=T,sep="\t",as.is=F)
head(d1)
head(d2)
is.na(match(d1[,1],d2[,1]))
sum(is.na(match(d1[,1],d2[,1])))
sum(which(is.na(match(d1[,1],d2[,1]))==T)
sum(which(is.na(match(d1[,1],d2[,1]))==T))
sum(which(is.na(match(d1[,1],d2[,1]))==T))
which(is.na(match(d1[,1],d2[,1]))
which(is.na(match(d1[,1],d2[,1])
which(is.na(match(d1[,1],d2[,1])
which(is.na(match(d1[,1],d2[,1])))
which(is.na(match(d1[,1],d2[,1])))
is.na(match(d1[,1],d2[,1]))
is.na(match(d2[,1],d1[,1]))
is.na(match(d1[,1],d2[,1]))
which(is.na(match(d1[,1],d2[,1]))==T)
which(is.na(match(d2[,1],d1[,1]))==T)
sum(is.na(match(d2[,1],d1[,1]))==T)
which(is.na(match(d2[,1],d1[,1]))==T)
as<-d2[which(is.na(match(d2[,1],d1[,1]))==T),]
dim(as)
write.table(as,file="as.data",sep="\t",sep="\t",quote=F)
write.table(as,file="as.data",sep="\t",quote=F)
naline<-apply(as[,2:33],1, is.na)
naline
naline<-apply(as[,2:33],1, all(is.na)
)
naline<-apply(as[,2:33],1, all(is.na))
naline<-apply(as[,2:33],1, function(x) all(is.na(x)))
naline
dim(as)
which(is.na(match(d1[,1],d2[,1]))==T)
as<-d2[which(is.na(match(d2[,1],d1[,1]))==T),]
dim(as)
naline<-apply(as[,2:33],1, function(x) all(is.na(x)))
length(naline)
which(naline==T)
head(as)
naline<-apply(as[,2:33],1, function(x) all(is.na(x)))
sum(naline)
naline
head(d1)
head(d2)
dim(as)
naline<-apply(as[,2:30],1, function(x) all(is.na(x)))
naline
head(as)
dim(as)
naline<-apply(as[,2:29],1, function(x) all(is.na(x)))
naline
asdata<-as[-naline,]
write.table(as,file="as.data",sep="\t",quote=F)
dim(asdata)
naline<-apply(as[,2:29],1, function(x) all(is.na(x)))
naline
naline<-which(apply(as[,2:29],1, function(x) all(is.na(x)))==T)
naline
asdata<-as[-naline,]
dim(asdata)
write.table(as,file="as.data",sep="\t",quote=F)
write.table(asdata,file="as.data",sep="\t",quote=F)
setwd("/home/gsc/Dropbox/CNV/AS/dat")
d1<-read.table("As_old.txt",head=T,sep="\t",as.is=F)
d2<-read.table("total.new.txt",head=T,sep="\t",as.is=F)
head(d1)
head(d2)
which(is.na(match(d1[,1],d2[,1]))==T)
as<-d2[which(is.na(match(d2[,1],d1[,1]))==T),]
dim(as)
head(as)
naline<-which(apply(as[,2:29],1, function(x) all(is.na(x)))==T)
asdata<-as[-naline,]
dim(asdata)
as<-d2[which(is.na(match(d2[,1],d1[,1]))==F),]
dim(as)
head(as)
naline<-which(apply(as[,2:29],1, function(x) all(is.na(x)))==T)
asdata<-as[-naline,]
dim(asdata)
write.table(asdata,file="as.data",sep="\t",quote=F)
sort(table(asdata[,1]))
sort(table(asdata[,1]))==2
which(sort(table(asdata[,1]))==2)
names(which(sort(table(asdata[,1]))==2))
match(asdata[,1],names(which(sort(table(asdata[,1]))==2)))
asdata[!is.na(match(asdata[,1],names(which(sort(table(asdata[,1]))==2)))),]
repasdata<-asdata[!is.na(match(asdata[,1],names(which(sort(table(asdata[,1]))==2)))),]
dim(repasdata)
sort(table(asdata[,1]))
write.table(repasdata,file="repas.data",quote=F,rownames=T,colnames=NA,sep="\t")
write.table(repasdata,file="repas.data",quote=F,row.names=T,col.names=NA,sep="\t")
repasdata<-asdata[is.na(match(asdata[,1],names(which(sort(table(asdata[,1]))==2)))),]
nonrepasdata<-asdata[is.na(match(asdata[,1],names(which(sort(table(asdata[,1]))==2)))),]
write.table(nonrepasdata,file="nonrepas.data",quote=F,row.names=T,col.names=NA,sep="\t")
read.table("nonrepas.data",head=T,sep="\t",as.is=F)
data<-read.table("nonrepas.data",head=T,sep="\t",as.is=F)
dim(data)
table(data[,33])
colnames(data)
data$ID02.1
table(data$ID02.1)
table(data[which(data$type=="As")]$ID02.1)
head(data)
table(data[which(data$type=="AS")]$ID02.1)
table(data[which(data$type=="AS"),33])
table(data[which(data$type=="AS"),]$ID02.1)
table(data[which(data$type=="control"),]$ID02.1)
table(data[which(data$type=="AS"),]$ID04.1)
table(data[which(data$type=="control"),]$ID04.1)
table(data[which(data$type=="control"),])
table(data[which(data$type=="control"),33])
table(data[which(data$type=="control"),])
head(data)
table(data[which(data$type=="control"),9])
table(data[which(data$type=="AS"),9])
dim(data)
is.na(data)
table(data[which(data$type=="control"),9])
table(data[which(data$type=="AS"),9])
table(data[which(data$type=="AS"),33])
table(data[which(data$type=="control"),33])
table(data[which(data$type=="AS"),9])
table(data[which(data$type=="AS"),5])
table(data[which(data$type=="control"),5])
#ID04
table(data[which(data$type=="control"),9])
table(data[which(data$type=="AS"),9])
table(data[which(data$type=="AS"),33])
165/208
c<-(165,38,2)/208
c<-(165,38,2)
c<-c(165,38,2)/208
c
sum(c)
d<-c(165,46,4)/
)
table(data[which(data$type=="control"),33])
d<-c(165,46,4)/219
d
d<-c(1,3,201)/219
d
a<-matrix(c(165,38,2,165,46,4),2)
a
a<-matrix(c(165,38,2,165,46,4),3)
a
a<-matrix(c(165,38,2,165,46,4),nrow=2,byrow=T)
a
x1<-c(165,38,2)
x2<-c(165,46,4)
prop.trend.test(s1,tot)
prop.trend.test(s1)
? prop.trend.test
prop.trend.test(x1,tot)
tot<-x1+x2
x1<-c(165,38,2)
x2<-c(165,46,4)
tot<-x1+x2
prop.trend.test(x1,tot)
x3<-c(0,0,202)
x4<-c(1,3,201)
tot<-x3+x4
prop.trend.test(x1,tot)
prop.trend.test(x3,tot)
data$type
data.matrix(data$type)
data.matrix(data.frame(data$type))
data.matrix(data.frame(data$type))-1
data$type
data.matrix(data.frame(data$type))
abs(data.matrix(data.frame(data$type))-2)
id02<-data$ID02.1
id02
? logistic
?? logistic
data$gender
gender<-abs(data.matrix(data.frame(data$gender))-2)
gender
gender<-abs(data.matrix(data.frame(data$gender)))
gender
data$age
glm<-glm(y~gender+age,family=binomial(logit),data=data)
glm<-glm(y~gender+age,family=binomial(logit))
y<-abs(data.matrix(data.frame(data$type))-2)
gender<-abs(data.matrix(data.frame(data$gender)))
age<-data$age
glm<-glm(y~gender+age,family=binomial(logit))
glm
summary(glm)
id02<-data$ID02.1
id04<-data$ID04.1
glm02<-glm(y~gender+age+id02,family=binomial(logit))
glm04<-glm(y~gender+age+id04,family=binomial(logit))
summary(glm02)
summary(glm04)
glm02o<-glm(y~gender+age+id02o,family=binomial(logit))
glm04o<-glm(y~gender+age+id04o,family=binomial(logit))
summary(glm02o)
summary(glm04o)
id02o<-data$ID02
id04o<-data$ID04
glm02o<-glm(y~gender+age+id02o,family=binomial(logit))
glm04o<-glm(y~gender+age+id04o,family=binomial(logit))
summary(glm02o)
summary(glm04o)
glm02<-glm(y~gender+age+id02,family=binomial(logit))
glm04<-glm(y~gender+age+id04,family=binomial(logit))
summary(glm02)
summary(glm04)
summary(glm02o)
summary(glm04o)
# to spss
p1<-data.frame(y,gender,age,id02)
p2<-data.frame(y,gender,age,id04)
p3<-data.frame(y,gender,age,id02o)
p4<-data.frame(y,gender,age,id04o)
head(p1)
head(p)
p<-data.frame(y,gender,age,id02,id04,id02o,id04o)
head(p)
write.table(p,file="spssdata.txt",quote=F,row.names=T,col.names=NA,sep="\t")
plot(density(id02)
plot(density(id02))
plot(density(id02))
plot(density(p$id02))
plot(density(p$id02),na.rm=T)
? density
density(p$id02,na.rm=T)
plot(density(p$id02,na.rm=T))
plot(density(p$id02[which(type==1)],na.rm=T))
plot(density(p$id02[which(p$y==1)],na.rm=T))
plot(density(p$id02[which(p$y==2)],na.rm=T))
which(p$y==2)
which(y==2)
y
plot(density(p$id02[which(y==0)],na.rm=T))
lines(density(p$id02[which(y==1)],na.rm=T))
plot(density(p$id02[which(y==1)],na.rm=T))
lines(density(p$id02[which(y==0)],na.rm=T))
plot(density(p$id02o[which(y==1)],na.rm=T))
lines(density(p$id02o[which(y==0)],na.rm=T))
plot(density(p$id04o[which(y==1)],na.rm=T))
lines(density(p$id04o[which(y==0)],na.rm=T))
legend("topright",legend=c("AS(208)","Control(219)"),col=c("red","green"),pty=c(1,2))
legend("topright",legend=c("AS(208)","Control(219)"),col=c("red","green")))
legend("topright",legend=c("AS(208)","Control(219)"),col=c("red","green"))
plot(density(p$id02o[which(y==1)],na.rm=T),lty=1,col="red")
lines(density(p$id02o[which(y==0)],na.rm=T),lty=2,col="green")
legend("topright",legend=c("AS(208)","Control(219)"),col=c("red","green"),lty=c(1,2))
pdf("cnvdistribution.pdf")
par(frow=c(2,1))
plot(density(p$id02o[which(y==1)],na.rm=T),lty=1,col="red")
lines(density(p$id02o[which(y==0)],na.rm=T),lty=2,col="green")
legend("topright",legend=c("AS(208)","Control(219)"),col=c("red","green"),lty=c(1,2))
plot(density(p$id04o[which(y==1)],na.rm=T),lty=1,col="red")
lines(density(p$id04o[which(y==0)],na.rm=T),lty=2,col="green")
legend("topright",legend=c("AS(208)","Control(219)"),col=c("red","green"),lty=c(1,2))
dev.off()
pdf("cnvdistribution.pdf")
par(mfrow=c(2,1))
plot(density(p$id02o[which(y==1)],na.rm=T),lty=1,col="red")
lines(density(p$id02o[which(y==0)],na.rm=T),lty=2,col="green")
legend("topright",legend=c("AS(208)","Control(219)"),col=c("red","green"),lty=c(1,2))
plot(density(p$id04o[which(y==1)],na.rm=T),lty=1,col="red")
lines(density(p$id04o[which(y==0)],na.rm=T),lty=2,col="green")
legend("topright",legend=c("AS(208)","Control(219)"),col=c("red","green"),lty=c(1,2))
dev.off()
pdf("cnvdistribution.pdf")
par(mfrow=c(2,1))
plot(density(p$id02o[which(y==1)],na.rm=T),lty=1,col="red",main="CNV Distribution of HLA-DRB5")
lines(density(p$id02o[which(y==0)],na.rm=T),lty=2,col="green")
legend("topright",legend=c("AS(208)","Control(219)"),col=c("red","green"),lty=c(1,2))
plot(density(p$id04o[which(y==1)],na.rm=T),lty=1,col="red",main="CNV Distribution of HLA-DAQ1")
lines(density(p$id04o[which(y==0)],na.rm=T),lty=2,col="green")
legend("topright",legend=c("AS(208)","Control(219)"),col=c("red","green"),lty=c(1,2))
dev.off()
d1<-read.table("APC27",sep="\t",as.is=F)
d2<-read.table("APC27",sep="\t",as.is=F)
setwd("/home/gsc/Dropbox/APCmeta")
d1<-read.table("APC27",sep="\t",as.is=F)
d2<-read.table("APC27",sep="\t",as.is=F)
setwd("/home/gsc/Dropbox/APCmeta")
d1<-read.table("APC27",sep="\t",as.is=F)
d2<-read.table("APC450",sep="\t",as.is=F)
merge(d1,d2)
merge(d1,d2,by.x=1,by.y=1)
